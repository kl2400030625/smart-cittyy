<div class="mt-4" id="manage-cities">
    <h3>Manage City Details</h3>
    <div class="card p-3 mb-4">
        <h4>Add New City</h4>
        <form>
            <div class="mb-3">
                <label for="cityName" class="form-label">City Name</label>
                <input type="text" class="form-control" id="cityName" required>
            </div>
            <div class="mb-3">
                <label for="cityDetails" class="form-label">City Details</label>
                <textarea class="form-control" id="cityDetails" rows="3" required></textarea>
            </div>
            <button type="submit" class="btn btn-success">Add City</button>
        </form>
    </div>
    
    <h4>Existing Cities</h4>
    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>City Name</th>
                    <th>Details</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="adminCitiesTbody">
                <!-- Filled dynamically -->
            </tbody>
        </table>
    </div>

    <script>
        (function(){
            const form = document.querySelector('#manage-cities form');
            const nameIn = document.getElementById('cityName');
            const detailsIn = document.getElementById('cityDetails');
            const tbody = document.getElementById('adminCitiesTbody');
            const key = 'cities';

            function load(){ try{ return JSON.parse(localStorage.getItem(key)||'[]'); }catch(e){return []} }
            function save(items){ localStorage.setItem(key, JSON.stringify(items)); }
            function escapeHtml(s){ if(s===null||s===undefined) return ''; return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

            function render(){ const items = load(); tbody.innerHTML=''; items.forEach(it=>{ const tr=document.createElement('tr'); tr.innerHTML = '<td>'+escapeHtml(it.name)+'</td><td>'+escapeHtml(it.details)+'</td><td><button class="btn btn-sm btn-warning" data-id="'+it.id+'" data-action="edit">Edit</button> <button class="btn btn-sm btn-danger" data-id="'+it.id+'" data-action="delete">Delete</button></td>'; tbody.appendChild(tr); }); }

            form.addEventListener('submit', function(e){ e.preventDefault(); const name = nameIn.value.trim(); const details = detailsIn.value.trim(); if(!name) return; const items = load(); items.push({ id: String(Date.now()), name, details }); save(items); form.reset(); render(); });

            tbody.addEventListener('click', function(e){ const btn = e.target.closest('button'); if(!btn) return; const id = btn.getAttribute('data-id'); const action = btn.getAttribute('data-action'); const items = load(); const idx = items.findIndex(x=>x.id===id); if(idx<0) return; if(action==='delete'){ items.splice(idx,1); save(items); render(); return; } if(action==='edit'){ const it = items[idx]; nameIn.value = it.name; detailsIn.value = it.details; items.splice(idx,1); save(items); } });

            render();
        })();
    </script>
</div>